## OpenAI API Examples

### Example 1: Product Extraction

**Request**:

```bash
curl https://api.openai.com/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer sk-YOUR_API_KEY" \
  -d '{
    "model": "gpt-4o-mini",
    "messages": [
      {
        "role": "system",
        "content": "You are a JSON-only product extractor. Return only valid JSON arrays, no other text."
      },
      {
        "role": "user",
        "content": "Extract products from:\n\nTrail Pro Backpack\nPrice: $189.99\n40L waterproof backpack\nBuy: https://store.com/trail-pro\n\nAdventure Pack\nPrice: $175.00\n45L capacity\nLink: https://store.com/adventure"
      }
    ],
    "temperature": 0.3,
    "max_tokens": 1000
  }'
```

**Response**:

```json
{
  "id": "chatcmpl-abc123",
  "object": "chat.completion",
  "created": 1729876543,
  "model": "gpt-4o-mini",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "[\n  {\n    \"name\": \"Trail Pro Backpack\",\n    \"price\": 189.99,\n    \"url\": \"https://store.com/trail-pro\",\n    \"sku\": \"TP-40L-001\",\n    \"source\": \"store.com\"\n  },\n  {\n    \"name\": \"Adventure Pack\",\n    \"price\": 175.00,\n    \"url\": \"https://store.com/adventure\",\n    \"sku\": \"AP-45L-002\",\n    \"source\": \"store.com\"\n  }\n]"
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 145,
    "completion_tokens": 98,
    "total_tokens": 243
  }
}
```

**Parsed Result**:

```json
[
  {
    "name": "Trail Pro Backpack",
    "price": 189.99,
    "url": "https://store.com/trail-pro",
    "sku": "TP-40L-001",
    "source": "store.com"
  },
  {
    "name": "Adventure Pack",
    "price": 175.0,
    "url": "https://store.com/adventure",
    "sku": "AP-45L-002",
    "source": "store.com"
  }
]
```

---

### Example 2: Chat with Tools (via AI SDK)

**Request** (handled by AI SDK):

```typescript
const result = await streamText({
  model: openai("gpt-4o-mini"),
  messages: [
    { role: "user", content: "Find me waterproof backpacks under $200" },
  ],
  system: "You are a shopping assistant...",
  tools: {
    searchWeb: tool({
      description: "Search the web",
      parameters: z.object({ query: z.string() }),
      execute: async ({ query }) => await webSearch(query),
    }),
  },
});
```

**Internal OpenAI Request** (generated by AI SDK):

```json
{
  "model": "gpt-4o-mini",
  "messages": [
    {
      "role": "system",
      "content": "You are a shopping assistant..."
    },
    {
      "role": "user",
      "content": "Find me waterproof backpacks under $200"
    }
  ],
  "tools": [
    {
      "type": "function",
      "function": {
        "name": "searchWeb",
        "description": "Search the web",
        "parameters": {
          "type": "object",
          "properties": {
            "query": { "type": "string" }
          },
          "required": ["query"]
        }
      }
    }
  ],
  "stream": true
}
```

**Internal OpenAI Response**:

```json
{
  "id": "chatcmpl-xyz789",
  "choices": [
    {
      "delta": {
        "tool_calls": [
          {
            "id": "call_abc123",
            "type": "function",
            "function": {
              "name": "searchWeb",
              "arguments": "{\"query\":\"waterproof backpacks under $200\"}"
            }
          }
        ]
      },
      "finish_reason": "tool_calls"
    }
  ]
}
```

---

### Example 3: Error - Rate Limit

**Request**:

```bash
curl https://api.openai.com/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer sk-YOUR_API_KEY" \
  -d '{
    "model": "gpt-4o-mini",
    "messages": [{"role": "user", "content": "test"}]
  }'
```

**Response**:

```json
{
  "error": {
    "message": "Rate limit reached for requests",
    "type": "requests",
    "param": null,
    "code": "rate_limit_exceeded"
  }
}
```

**Status Code**: 429

---

### Example 4: Error - Invalid API Key

**Request**:

```bash
curl https://api.openai.com/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer invalid_key" \
  -d '{
    "model": "gpt-4o-mini",
    "messages": [{"role": "user", "content": "test"}]
  }'
```

**Response**:

```json
{
  "error": {
    "message": "Incorrect API key provided: invalid_key. You can find your API key at https://platform.openai.com/account/api-keys.",
    "type": "invalid_request_error",
    "param": null,
    "code": "invalid_api_key"
  }
}
```

**Status Code**: 401

---
